steps:

- task: HelmDeploy@0
  displayName: 'Helm Package'  
  inputs:
    command: package
    chartPath: $(chartPath)
    chartVersion: $(Build.SourceBranchName)
    arguments: '--app-version $(Build.SourceBranchName)'
    destination: $(Build.ArtifactStagingDirectory)

# - task: HelmDeploy@0
#   displayName: Helm save
#   inputs:
#     command: save
#     chartNameForACR: 'charts/$(ACR.ContainerRepository):$(Build.BuildId)'
#     chartPathForACR: $(Build.ArtifactStagingDirectory)/$(ACR.ContainerRepository)-$(Build.BuildId).tgz
#     azureSubscriptionEndpointForACR: $(ACR.ServiceConnection)
#     azureResourceGroupForACR: $(ACR.ResourceGroupName)
#     azureContainerRegistry: $(ACR.ContainerRepository)

# - task: AzureCLI@1
#   inputs:
#     azureSubscription: $(Arm.ServiceConnection)
#     scriptLocation: inlineScript
#     inlineScript: az acr helm push -n $(acrName) $(Build.ArtifactStagingDirectory)/$(ACR.ContainerRepository)-$(Build.BuildId).tgz