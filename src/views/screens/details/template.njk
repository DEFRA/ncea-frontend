{% extends 'layout/default.njk' %}

{% from 'govuk/components/breadcrumbs/macro.njk' import govukBreadcrumbs %}
{% from 'govuk/components/tabs/macro.njk' import govukTabs %}
{% from "govuk/components/button/macro.njk" import govukButton %}

{% from 'partials/details/macro.njk' import details %}

{% block beforeContent %}
  {{ super() }}

  {% set breadcrumbItems = [{
      text: 'Home',
      href: routes.homePage,
      attributes: {
        'data-do-storage-reset': ''
      }
    },
    {
      text: 'Search results',
      href: routes.searchResults
    }]
  %}

  {% if docDetails.title %}
    {% set breadcrumbItems = breadcrumbItems.concat([
      {
        text: docDetails.title,
        href: '#'
      }
    ]) %}
  {% endif %}

  {{ govukBreadcrumbs({
    items: breadcrumbItems
  }) }}
{% endblock %}

{% block content %}
  {% if docDetails !== undefined and docDetails.title %}
    {% set generalHTML = details({options: detailsTabOptions.general, docDetails: docDetails}) %}

    <h1 class='govuk-heading-m details-title'>{{docDetails.title}}</h1>

    {% set openDataAttributes = {} %}
    {% if item.resourceLocator %}
      {% set openDataAttributes = openDataAttributes | merge({
        onclick: "openDataModal('" + item.resourceLocator + "')"
      }) %}
    {% else %}
      {% set openDataAttributes = openDataAttributes | merge({disabled: "true"}) %}
    {% endif %}
    {{ govukButton({
    text: 'Open data',
    attributes: openDataAttributes,
    classes: 'govuk-!-margin-bottom-4'
  }) }}

    {{ govukTabs({
    items: [
      {
        label: 'General',
        id: 'general',
        panel: {
          html: generalHTML
        }
      },
      {
        label: 'Access',
        id: 'access',
        panel: {
          html: accessHtml
        }
      },
      {
        label: 'Natural Capital',
        id: 'natural-capital',
        panel: {
          html: naturalCapitalHTML
        }
      },
      {
        label: 'Quality',
        id: 'quality',
        panel: {
          html: qualityHtml
        }
      },
      {
        label: 'Geography',
        id: 'geography',
        panel: {
          html: geographyHtml
        }
      },
      {
        label: 'Governance',
        id: 'governance',
        panel: {
          html: governanceHtml
        }
      },
      {
        label: 'License',
        id: 'license',
        panel: {
          html: plicenseHtml
        }
      }
    ]
  }) }}

  {% else %}
    <p>Error</p>
  {% endif %}
{% endblock %}